\hypertarget{compute__axis__commands_8c_source}{}\doxysection{compute\+\_\+axis\+\_\+commands.\+c}
\label{compute__axis__commands_8c_source}\index{Autodrone32/Src/compute\_axis\_commands.c@{Autodrone32/Src/compute\_axis\_commands.c}}
\mbox{\hyperlink{compute__axis__commands_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00001}00001 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00002}00002 \textcolor{comment}{  October 2012}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00003}00003 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00004}00004 \textcolor{comment}{  aq32Plus Rev -\/}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00005}00005 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00006}00006 \textcolor{comment}{  Copyright (c) 2012 John Ihlein.  All rights reserved.}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00007}00007 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00008}00008 \textcolor{comment}{  Open Source STM32 Based Multicopter Controller Software}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00009}00009 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00010}00010 \textcolor{comment}{  Includes code and/or ideas from:}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00011}00011 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00012}00012 \textcolor{comment}{  1)AeroQuad}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00013}00013 \textcolor{comment}{  2)BaseFlight}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00014}00014 \textcolor{comment}{  3)CH Robotics}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00015}00015 \textcolor{comment}{  4)MultiWii}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00016}00016 \textcolor{comment}{  5)S.O.H. Madgwick}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00017}00017 \textcolor{comment}{  6)UAVX}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00018}00018 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00019}00019 \textcolor{comment}{  Designed to run on the AQ32 Flight Control Board}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00020}00020 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00021}00021 \textcolor{comment}{  This program is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00022}00022 \textcolor{comment}{  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00023}00023 \textcolor{comment}{  the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00024}00024 \textcolor{comment}{  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00025}00025 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00026}00026 \textcolor{comment}{  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00027}00027 \textcolor{comment}{  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00028}00028 \textcolor{comment}{  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00029}00029 \textcolor{comment}{  GNU General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00030}00030 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00031}00031 \textcolor{comment}{  You should have received a copy of the GNU General Public License}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00032}00032 \textcolor{comment}{  along with this program. If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00033}00033 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{board_8h}{board.h}}"{}}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00041}\mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{00041}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{attCmd}}[3];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00043}\mbox{\hyperlink{compute__axis__commands_8c_ab07bd323d95ccecc4ad892c23b921712}{00043}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_ab07bd323d95ccecc4ad892c23b921712}{attPID}}[3];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00045}\mbox{\hyperlink{compute__axis__commands_8c_ab77481ff9ad18ebb1f89ab1946ca7dae}{00045}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_ab77481ff9ad18ebb1f89ab1946ca7dae}{ratePID}}[3];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00047}\mbox{\hyperlink{compute__axis__commands_8c_ac6595ac6fa25e26be6455e68cc6cdea9}{00047}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_ac6595ac6fa25e26be6455e68cc6cdea9}{rateCmd}}[3];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00049}\mbox{\hyperlink{compute__axis__commands_8c_acf47deadcb64887bffcfc75e4b4cf36e}{00049}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_acf47deadcb64887bffcfc75e4b4cf36e}{headingReference}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00051}\mbox{\hyperlink{compute__axis__commands_8c_aeadf10edda82c844091f32339605e1c3}{00051}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_aeadf10edda82c844091f32339605e1c3}{altitudeHoldReference}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00053}\mbox{\hyperlink{compute__axis__commands_8c_a4c5161941d9a2168ef4bd69e018bfbe8}{00053}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_a4c5161941d9a2168ef4bd69e018bfbe8}{throttleReference}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00055}\mbox{\hyperlink{compute__axis__commands_8c_a800904bb2535cfb17e45fb15cfcbc51f}{00055}} \textcolor{keywordtype}{float}   \mbox{\hyperlink{compute__axis__commands_8c_a800904bb2535cfb17e45fb15cfcbc51f}{verticalVelocityCmd}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00058}00058 \textcolor{comment}{// Compute Axis Commands}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00060}00060 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00061}\mbox{\hyperlink{compute__axis__commands_8c_a6ea978441fb2878a2926d7009c903962}{00061}} \textcolor{keywordtype}{void} \mbox{\hyperlink{compute__axis__commands_8c_a6ea978441fb2878a2926d7009c903962}{computeAxisCommands}}(\textcolor{keywordtype}{float} dt)}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00062}00062 \{}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00063}00063     \textcolor{keywordtype}{float} error;}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00064}00064     \textcolor{keywordtype}{float} tempAttCompensation;}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00066}00066     \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_a37e90f5e3bd99fac2021fb3a326607d4}{mode}} == \mbox{\hyperlink{_autodrone32_8h_adf764cbdea00d65edcd07bb9953ad2b7a1e3af4a87374fcc9dcb397ee98b47b65}{FLIGHT}})}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00067}00067     \{}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00068}00068         \mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{attCmd}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ] = \mbox{\hyperlink{flight__command_8h_ae767c84bb0f764c266954094c2869142}{rxCommand}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ] * \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a9a08871f138cc5097ddd31faf2d37d7a}{attitudeScaling}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00069}00069         \mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{attCmd}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}]    = \mbox{\hyperlink{flight__command_8h_ae767c84bb0f764c266954094c2869142}{rxCommand}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] * \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a9a08871f138cc5097ddd31faf2d37d7a}{attitudeScaling}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00070}00070         \mbox{\hyperlink{compute__axis__commands_8c_ac6595ac6fa25e26be6455e68cc6cdea9}{rateCmd}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}]  = \mbox{\hyperlink{flight__command_8h_ae767c84bb0f764c266954094c2869142}{rxCommand}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}  ] * \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a8f90af8f77a607661ad812a44bf427a4}{yawRateScaling}};}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00072}00072         error = \mbox{\hyperlink{utilities_8c_a3eb5c7ac4a35ae17b26f4b67eec87eaf}{standardRadianFormat}}(\mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{attCmd}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}}] -\/ \mbox{\hyperlink{_autodrone32_8h_ae98e6f5c865af95578862f633a30b769}{sensors}}.\mbox{\hyperlink{structsensors__t_a648770241f13383e5c763d3d137e017e}{attitude500Hz}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}}]);}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00073}00073         \mbox{\hyperlink{compute__axis__commands_8c_ab07bd323d95ccecc4ad892c23b921712}{attPID}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}}]  = \mbox{\hyperlink{pid_8c_acb47bee3fd9e9579d91fc045a7f87e8d}{updatePID}}(error, dt, \mbox{\hyperlink{pid_8c_a2411ec293e48a57a17a63d25e1c47907}{pidReset}}, \&\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_ad725b40cda69d752a3ab6af73be69665}{PID}}[\mbox{\hyperlink{_autodrone32_8h_aa6cdf8ae8cfa8c94747830d9e0431643}{ROLL\_ATT\_PID}} ]);}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00075}00075         error = \mbox{\hyperlink{utilities_8c_a3eb5c7ac4a35ae17b26f4b67eec87eaf}{standardRadianFormat}}(\mbox{\hyperlink{compute__axis__commands_8c_aa2d7eed0bc462ac7393d0def9c484b5e}{attCmd}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] + \mbox{\hyperlink{_autodrone32_8h_ae98e6f5c865af95578862f633a30b769}{sensors}}.\mbox{\hyperlink{structsensors__t_a648770241f13383e5c763d3d137e017e}{attitude500Hz}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}]);}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00076}00076         \mbox{\hyperlink{compute__axis__commands_8c_ab07bd323d95ccecc4ad892c23b921712}{attPID}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] = \mbox{\hyperlink{pid_8c_acb47bee3fd9e9579d91fc045a7f87e8d}{updatePID}}(error, dt, \mbox{\hyperlink{pid_8c_a2411ec293e48a57a17a63d25e1c47907}{pidReset}}, \&\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_ad725b40cda69d752a3ab6af73be69665}{PID}}[\mbox{\hyperlink{_autodrone32_8h_aa5049e31750ce30b89716ffca24dc90d}{PITCH\_ATT\_PID}}]);}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00078}00078         error = \mbox{\hyperlink{compute__axis__commands_8c_ac6595ac6fa25e26be6455e68cc6cdea9}{rateCmd}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] -\/ \mbox{\hyperlink{_autodrone32_8h_ae98e6f5c865af95578862f633a30b769}{sensors}}.\mbox{\hyperlink{structsensors__t_a096936016bc19288738dbf774d57d563}{gyro500Hz}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00079}00079         \mbox{\hyperlink{compute__axis__commands_8c_ab77481ff9ad18ebb1f89ab1946ca7dae}{ratePID}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] = \mbox{\hyperlink{pid_8c_acb47bee3fd9e9579d91fc045a7f87e8d}{updatePID}}(error, dt, \mbox{\hyperlink{pid_8c_a2411ec293e48a57a17a63d25e1c47907}{pidReset}}, \&\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_ad725b40cda69d752a3ab6af73be69665}{PID}}[\mbox{\hyperlink{_autodrone32_8h_a8fea470ced437a1f4a6e41b1a30b0d05}{YAW\_RATE\_PID}}  ]);}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00083}00083         throttleCmd = \mbox{\hyperlink{flight__command_8h_ae767c84bb0f764c266954094c2869142}{rxCommand}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}];}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00084}00084     \}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00087}00087 \}}
\DoxyCodeLine{\Hypertarget{compute__axis__commands_8c_source_l00088}00088 }

\end{DoxyCode}
