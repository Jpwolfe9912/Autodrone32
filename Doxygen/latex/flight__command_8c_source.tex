\hypertarget{flight__command_8c_source}{}\doxysection{flight\+\_\+command.\+c}
\label{flight__command_8c_source}\index{Autodrone32/Src/flight\_command.c@{Autodrone32/Src/flight\_command.c}}
\mbox{\hyperlink{flight__command_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00001}00001 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00002}00002 \textcolor{comment}{  October 2012}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00003}00003 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00004}00004 \textcolor{comment}{  aq32Plus Rev -\/}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00005}00005 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00006}00006 \textcolor{comment}{  Copyright (c) 2012 John Ihlein.  All rights reserved.}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00007}00007 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00008}00008 \textcolor{comment}{  Open Source STM32 Based Multicopter Controller Software}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00009}00009 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00010}00010 \textcolor{comment}{  Includes code and/or ideas from:}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00011}00011 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00012}00012 \textcolor{comment}{  1)AeroQuad}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00013}00013 \textcolor{comment}{  2)BaseFlight}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00014}00014 \textcolor{comment}{  3)CH Robotics}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00015}00015 \textcolor{comment}{  4)MultiWii}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00016}00016 \textcolor{comment}{  5)S.O.H. Madgwick}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00017}00017 \textcolor{comment}{  6)UAVX}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00018}00018 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00019}00019 \textcolor{comment}{  Designed to run on the AQ32 Flight Control Board}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00020}00020 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00021}00021 \textcolor{comment}{  This program is free software: you can redistribute it and/or modify}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00022}00022 \textcolor{comment}{  it under the terms of the GNU General Public License as published by}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00023}00023 \textcolor{comment}{  the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00024}00024 \textcolor{comment}{  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00025}00025 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00026}00026 \textcolor{comment}{  This program is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00027}00027 \textcolor{comment}{  but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00028}00028 \textcolor{comment}{  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00029}00029 \textcolor{comment}{  GNU General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00030}00030 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00031}00031 \textcolor{comment}{  You should have received a copy of the GNU General Public License}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00032}00032 \textcolor{comment}{  along with this program. If not, see <http://www.gnu.org/licenses/>.}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00033}00033 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{board_8h}{board.h}}"{}}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00040}00040 \textcolor{comment}{// Process Pilot Commands Defines and Variables}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00042}00042 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00043}\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{00043}} \textcolor{keywordtype}{float}    \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[12] = \{ 0.0f, 0.0f, 0.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f, 2000.0f \};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00045}\mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{00045}} uint8\_t  \mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[3]         = \{ \textcolor{keyword}{true}, \textcolor{keyword}{true}, \textcolor{keyword}{true} \};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00046}\mbox{\hyperlink{flight__command_8c_afba620164d81adc771510752f70e7cc8}{00046}} uint8\_t  \mbox{\hyperlink{flight__command_8c_afba620164d81adc771510752f70e7cc8}{previousCommandInDetent}}[3] = \{ \textcolor{keyword}{true}, \textcolor{keyword}{true}, \textcolor{keyword}{true} \};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00049}00049 \textcolor{keyword}{extern} uint16\_t \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{drv__ibus_8h_aad403df27c4671b0787f75525ee666ad}{RC\_CHANNELS}}];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00051}00051 \textcolor{comment}{// Flight Mode Defines and Variables}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00053}00053 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00054}\mbox{\hyperlink{flight__command_8c_a37e90f5e3bd99fac2021fb3a326607d4}{00054}} uint8\_t \mbox{\hyperlink{flight__command_8c_a37e90f5e3bd99fac2021fb3a326607d4}{mode}} = \mbox{\hyperlink{_autodrone32_8h_adf764cbdea00d65edcd07bb9953ad2b7a20364949ea9fb383c6b8baf4bf249c6a}{ROVER}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00056}\mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{00056}} uint8\_t \mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{headingHoldEngaged}}     = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00059}00059 \textcolor{comment}{// Arm State Variables}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00061}00061 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00062}\mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{00062}} \mbox{\hyperlink{_autodrone32_8h_a3d5a901a753342ccfc67d9706af13165}{semaphore\_t}} \mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}}          = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00063}\mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{00063}} uint8\_t     \mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{armingTimer}}    = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00064}\mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{00064}} uint8\_t     \mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00067}00067 \textcolor{comment}{// Vertical Mode State Variables}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00069}00069 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00070}\mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{00070}} uint8\_t  \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00072}\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{00072}} uint16\_t \mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} = \mbox{\hyperlink{_autodrone32_8h_ad9365648c4acd0f83d7a5faa319d3f20}{MINCOMMAND}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00073}\mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{00073}} uint16\_t \mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} = \mbox{\hyperlink{_autodrone32_8h_ad9365648c4acd0f83d7a5faa319d3f20}{MINCOMMAND}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00075}\mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{00075}} uint8\_t  \mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}}         = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00076}\mbox{\hyperlink{flight__command_8c_af874fbf27e0dff44290bd37662de6baa}{00076}} uint8\_t  \mbox{\hyperlink{flight__command_8c_af874fbf27e0dff44290bd37662de6baa}{previousVertRefCmdInDetent}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00078}\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{00078}} \textcolor{keywordtype}{float}    \mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00081}00081 \textcolor{comment}{// Read Flight Commands}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00083}00083 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00084}\mbox{\hyperlink{flight__command_8c_a9cd2a65048398c923b5603a2ce46b2a2}{00084}} \textcolor{keywordtype}{void} \mbox{\hyperlink{flight__command_8c_a9cd2a65048398c923b5603a2ce46b2a2}{processFlightCommands}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00085}00085 \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00086}00086     uint8\_t channel;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00087}00087     uint8\_t channelsToRead = 8;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00089}00089     \textcolor{keywordtype}{float} hdgDelta, simpleX, simpleY;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00091}00091     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{drv__ibus_8c_af6184e9a83b153bfe00e7716282f04d1}{rcActive}} == \textcolor{keyword}{true} )}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00092}00092     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00093}00093 \textcolor{comment}{//      // Read receiver commands}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00094}00094 \textcolor{comment}{//      if (eepromConfig.receiverType == PPM)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00095}00095 \textcolor{comment}{//          channelsToRead = eepromConfig.ppmChannels;}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00096}00096 \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00097}00097 \textcolor{comment}{//      for (channel = 0; channel < channelsToRead; channel++)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00098}00098 \textcolor{comment}{//      \{}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00099}00099 \textcolor{comment}{//          if (eepromConfig.receiverType == SPEKTRUM)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00100}00100 \textcolor{comment}{//              ibusChannels[channel] = spektrumRead(eepromConfig.rcMap[channel]);}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00101}00101 \textcolor{comment}{//          else if (eepromConfig.receiverType == SBUS)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00102}00102 \textcolor{comment}{//              ibusChannels[channel] = sBusRead(eepromConfig.rcMap[channel]);}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00103}00103 \textcolor{comment}{//          else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00104}00104 \textcolor{comment}{//              ibusChannels[channel] = rxRead(eepromConfig.rcMap[channel]);}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00105}00105 \textcolor{comment}{//      \}}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00107}00107 \textcolor{comment}{//      ibusChannels[ROLL]  -\/= eepromConfig.midCommand;  // Roll Range  -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00108}00108 \textcolor{comment}{//      ibusChannels[PITCH] -\/= eepromConfig.midCommand;  // Pitch Range -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00109}00109 \textcolor{comment}{//      ibusChannels[YAW]   -\/= eepromConfig.midCommand;  // Yaw Range   -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00110}00110 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00111}00111         \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}}]  = (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}}] * 2) -\/ 2000;  \textcolor{comment}{// Roll Range  -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00112}00112         \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] = (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] * 2) -\/ 2000;   \textcolor{comment}{// Pitch Range -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00113}00113         \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}]   = (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] * 2) -\/ 2000; \textcolor{comment}{// Yaw Range   -\/1000:1000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00115}00115 \textcolor{comment}{//      for (channel = 3; channel < channelsToRead; channel++)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00116}00116 \textcolor{comment}{//          ibusChannels[channel] -\/= eepromConfig.midCommand -\/ MIDCOMMAND;  // Range 2000:4000}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00117}00117         \textcolor{keywordflow}{for} (channel = 3; channel < channelsToRead; channel++)}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00118}00118             \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] *= 2;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00119}00119     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00121}00121     \textcolor{comment}{// Set past command in detent values}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00122}00122     \textcolor{keywordflow}{for} (channel = 0; channel < 3; channel++)}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00123}00123         \mbox{\hyperlink{flight__command_8c_afba620164d81adc771510752f70e7cc8}{previousCommandInDetent}}[channel] = \mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[channel];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00125}00125     \textcolor{comment}{// Apply deadbands and set detent discretes'}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00126}00126     \textcolor{keywordflow}{for} (channel = 0; channel < 3; channel++)}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00127}00127     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00128}00128         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] <= \mbox{\hyperlink{flight__command_8h_a196c194bd32527a119ac607d3b2330b6}{DEADBAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] >= -\/\mbox{\hyperlink{flight__command_8h_a196c194bd32527a119ac607d3b2330b6}{DEADBAND}}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00129}00129         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00130}00130             \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00131}00131             \mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[channel] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00132}00132         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00133}00133         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00134}00134         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00135}00135             \mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[channel] = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00136}00136             \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] > 0)}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00137}00137             \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00138}00138                 \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] = (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] -\/ \mbox{\hyperlink{flight__command_8h_a196c194bd32527a119ac607d3b2330b6}{DEADBAND}}) * \mbox{\hyperlink{flight__command_8h_aff2db53de34ab9f0f712f2cdef478882}{DEADBAND\_SLOPE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00139}00139             \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00140}00140             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00141}00141             \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00142}00142                 \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] = (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[channel] + \mbox{\hyperlink{flight__command_8h_a196c194bd32527a119ac607d3b2330b6}{DEADBAND}}) * \mbox{\hyperlink{flight__command_8h_aff2db53de34ab9f0f712f2cdef478882}{DEADBAND\_SLOPE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00143}00143             \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00144}00144         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00145}00145     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00148}00148 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00149}00149     \textcolor{comment}{/*      Check for disarm switch */}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00150}00150     \textcolor{keywordflow}{if}(\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a265717fcdca0aad3e296d063c4f1b760}{AUX1}}] < \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})\{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00151}00151         \mbox{\hyperlink{pid_8c_aaf22589c0540858f845cba698115b4dd}{zeroPIDstates}}();}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00152}00152         \mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00153}00153         \mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00154}00154     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00155}00155     \textcolor{comment}{/*      Check for arm switch and throttle low   */}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00156}00156     \textcolor{keywordflow}{if}((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a265717fcdca0aad3e296d063c4f1b760}{AUX1}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] < \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a6daa80d9fe2438fcc4b755817f9502a6}{minCheck}}) \&\& (\mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} == \textcolor{keyword}{false}))\{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00157}00157         \mbox{\hyperlink{pid_8c_aaf22589c0540858f845cba698115b4dd}{zeroPIDstates}}();}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00158}00158         \mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00159}00159     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00161}00161     \textcolor{comment}{// Check for low throttle}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00162}00162     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] < \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a6daa80d9fe2438fcc4b755817f9502a6}{minCheck}} )}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00163}00163     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00164}00164         \textcolor{comment}{// Check for disarm command ( low throttle, left yaw )}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00165}00165         \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] < (\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a6daa80d9fe2438fcc4b755817f9502a6}{minCheck}} -\/ \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})) \&\& (\mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} == \textcolor{keyword}{true}) )}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00166}00166         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00167}00167             \mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}}++;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00169}00169             \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}} > \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a4eb36c5679c8fb9f8b9cb2721880ef07}{disarmCount}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00170}00170             \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00171}00171                 \mbox{\hyperlink{pid_8c_aaf22589c0540858f845cba698115b4dd}{zeroPIDstates}}();}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00172}00172                 \mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00173}00173                 \mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00174}00174             \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00175}00175         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00176}00176         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00177}00177         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00178}00178             \mbox{\hyperlink{flight__command_8c_abaaaab74a851da13a44ccd63988196cc}{disarmingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00179}00179         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00181}00181         \textcolor{comment}{// Check for gyro bias command ( low throttle, left yaw, aft pitch, right roll )}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00182}00182         \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}  ] < (\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a6daa80d9fe2438fcc4b755817f9502a6}{minCheck}} -\/ \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})) \&\&}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00183}00183                 (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ] > (\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a1128de0037d8dd93b3824b375c463bd3}{maxCheck}} -\/ \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})) \&\&}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00184}00184                 (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] < (\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a6daa80d9fe2438fcc4b755817f9502a6}{minCheck}} -\/ \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})) )}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00185}00185         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00186}00186             \mbox{\hyperlink{mpu6000_8c_acb7732c2d9d2c63ad23af99706e5941d}{computeMPU6000RTData}}();}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00187}00187             pulseMotors(3);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00188}00188         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00190}00190         \textcolor{comment}{// Check for arm command ( low throttle, right yaw)}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00191}00191         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] > (\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a1128de0037d8dd93b3824b375c463bd3}{maxCheck}} -\/ \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) ) \&\& (\mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} == \textcolor{keyword}{false}) \&\& (\mbox{\hyperlink{drv__system_8c_aa794ebe01a5f29bfc614d907cfbd1199}{execUp}} == \textcolor{keyword}{true}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00192}00192         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00193}00193             \mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{armingTimer}}++;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00194}00194 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00195}00195             \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{armingTimer}} > \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a8331c3665459f6d7309504ccce4e45f4}{armCount}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00196}00196             \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00197}00197                 \mbox{\hyperlink{pid_8c_aaf22589c0540858f845cba698115b4dd}{zeroPIDstates}}();}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00198}00198                 \mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00199}00199                 \mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{armingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00200}00200             \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00201}00201         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00202}00202         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00203}00203         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00204}00204             \mbox{\hyperlink{flight__command_8c_aa17cd4729b354f25c53300d973288213}{armingTimer}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00205}00205         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00206}00206     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00210}00210     \textcolor{comment}{// Check for armed true and throttle command > minThrottle}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00212}00212     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a8a1c07a2b10dfb3f7633b8db1d1dac4a}{armed}} == \textcolor{keyword}{true}) \&\& (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] > \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a15003441b8f0bb4c12c4f417e76e27a9}{minThrottle}}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00213}00213         \mbox{\hyperlink{pid_8c_a2411ec293e48a57a17a63d25e1c47907}{pidReset}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00214}00214     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00215}00215         \mbox{\hyperlink{pid_8c_a2411ec293e48a57a17a63d25e1c47907}{pidReset}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00218}00218 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00219}00219     \textcolor{comment}{// Check AUX1 for rate, attitude, or GPS mode (3 Position Switch) NOT COMPLETE YET....}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00221}00221     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a265717fcdca0aad3e296d063c4f1b760}{AUX1}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (flightMode == RATE))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00222}00222     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00223}00223         flightMode = ATTITUDE;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00224}00224         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_aa6cdf8ae8cfa8c94747830d9e0431643}{ROLL\_ATT\_PID}},  0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00225}00225         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_aa5049e31750ce30b89716ffca24dc90d}{PITCH\_ATT\_PID}}, 0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00226}00226         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a52de2a501e95e89b76b389a9a9677a12}{HEADING\_PID}},   0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00227}00227     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00228}00228     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a265717fcdca0aad3e296d063c4f1b760}{AUX1}}] <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (flightMode == ATTITUDE))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00229}00229     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00230}00230         flightMode = RATE;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00231}00231         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a235532884e69e785781acb60c65bed49}{ROLL\_RATE\_PID}},  0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00232}00232         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a1958b73d2ee48b59a1c8f506881ee0f0}{PITCH\_RATE\_PID}}, 0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00233}00233         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a8fea470ced437a1f4a6e41b1a30b0d05}{YAW\_RATE\_PID}},   0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00234}00234     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00238}00238     \textcolor{comment}{// Check yaw in detent and flight mode to determine hdg hold engaged state}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00240}00240     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] == \textcolor{keyword}{true}) \&\& (flightMode == ATTITUDE) \&\& (\mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{headingHoldEngaged}} == \textcolor{keyword}{false}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00241}00241     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00242}00242         \mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{headingHoldEngaged}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00243}00243         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a52de2a501e95e89b76b389a9a9677a12}{HEADING\_PID}},  0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00244}00244         \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a8fea470ced437a1f4a6e41b1a30b0d05}{YAW\_RATE\_PID}}, 0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00245}00245         \mbox{\hyperlink{compute__axis__commands_8c_acf47deadcb64887bffcfc75e4b4cf36e}{headingReference}} = \mbox{\hyperlink{_autodrone32_8h_a15de01b6a723694ef8a8762257f77282}{heading}}.\mbox{\hyperlink{structheading__t_a6e374ac55d96352014b0fc2b4cad4f1e}{mag}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00246}00246     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00248}00248     \textcolor{keywordflow}{if} (((\mbox{\hyperlink{flight__command_8c_aa7ec4b36be7336ea09ed4944e3029c78}{commandInDetent}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] == \textcolor{keyword}{false}) || (flightMode != ATTITUDE)) \&\& (\mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{headingHoldEngaged}} == \textcolor{keyword}{true}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00249}00249     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00250}00250         \mbox{\hyperlink{flight__command_8c_aa5e0dd4f5a127ad9b7df7da86f717820}{headingHoldEngaged}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00251}00251     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00255}00255     \textcolor{comment}{// Simple Mode Command Processing}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00257}00257     \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a6f9b1805488210e791f5a08407e155a3}{AUX3}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00258}00258     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00259}00259         hdgDelta = \mbox{\hyperlink{_autodrone32_8h_ae98e6f5c865af95578862f633a30b769}{sensors}}.\mbox{\hyperlink{structsensors__t_a648770241f13383e5c763d3d137e017e}{attitude500Hz}}[\mbox{\hyperlink{_autodrone32_8h_ac71b1e54b98dc1031873048bc61d0438}{YAW}}] -\/ \mbox{\hyperlink{_autodrone32_8h_af8f7ecb6c6b59d5ecab88bd230764ea3}{homeData}}.\mbox{\hyperlink{structhome_data__t_a462c6c4caa2aff6c8fbf6d0b73a53e99}{magHeading}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00260}00260 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00261}00261         hdgDelta = \mbox{\hyperlink{utilities_8c_a3eb5c7ac4a35ae17b26f4b67eec87eaf}{standardRadianFormat}}(hdgDelta);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00263}00263         simpleX = cosf(hdgDelta) * \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] + sinf(hdgDelta) * \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00265}00265         simpleY = cosf(hdgDelta) * \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ] -\/ sinf(hdgDelta) * \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00267}00267         \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_af902416f65138704a180dbae2dc9d8f2}{ROLL}} ] = simpleY;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00269}00269         \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_acd633835a520a62245ec6cfeb6d00e97}{PITCH}}] = simpleX;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00270}00270     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00274}00274     \textcolor{comment}{// Vertical Mode Command Processing}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00276}00276     \mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} = \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] -\/ \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_ac06a95e1662c379031acb4653f855d5e}{midCommand}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00278}00278     \textcolor{comment}{// Set past altitude reference in detent value}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00279}00279     \mbox{\hyperlink{flight__command_8c_af874fbf27e0dff44290bd37662de6baa}{previousVertRefCmdInDetent}} = \mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00280}00280 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00281}00281     \textcolor{comment}{// Apply deadband and set detent discrete'}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00282}00282     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} <= \mbox{\hyperlink{flight__command_8h_a9c78c544264501fdc2d5447a8f3a66c3}{ALT\_DEADBAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} >= -\/\mbox{\hyperlink{flight__command_8h_a9c78c544264501fdc2d5447a8f3a66c3}{ALT\_DEADBAND}}))}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00283}00283     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00284}00284         \mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} = 0;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00285}00285         \mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00286}00286     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00287}00287     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00288}00288     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00289}00289         \mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00290}00290         \textcolor{keywordflow}{if} (\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} > 0)}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00291}00291         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00292}00292             \mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} = (\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} -\/ \mbox{\hyperlink{flight__command_8h_a9c78c544264501fdc2d5447a8f3a66c3}{ALT\_DEADBAND}}) * \mbox{\hyperlink{flight__command_8h_abde289a36c7acca8016f10eb346fab3e}{ALT\_DEADBAND\_SLOPE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00293}00293         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00294}00294         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00295}00295         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00296}00296             \mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} = (\mbox{\hyperlink{flight__command_8c_a79ae4259b91c06c5a05004cbc3ae5def}{verticalReferenceCommand}} + \mbox{\hyperlink{flight__command_8h_a9c78c544264501fdc2d5447a8f3a66c3}{ALT\_DEADBAND}}) * \mbox{\hyperlink{flight__command_8h_abde289a36c7acca8016f10eb346fab3e}{ALT\_DEADBAND\_SLOPE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00297}00297         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00298}00298     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00302}00302     \textcolor{comment}{// Vertical Mode State Machine}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00304}00304     \textcolor{keywordflow}{switch} (\mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00305}00305     \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00306}00306     \textcolor{keywordflow}{case} \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}}:}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00307}00307         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX2 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00308}00308         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00309}00309             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a495e513812504424d03296e0e8e8ef55}{ALT\_HOLD\_FIXED\_AT\_ENGAGEMENT\_ALT}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00310}00310             \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_aa6830d4f5afbd59e14b09b97edc46b0a}{HDOT\_PID}},        0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00311}00311             \mbox{\hyperlink{pid_8c_a02dc45a9a10c03f0dc29ef31c0da5368}{setPIDstates}}(\mbox{\hyperlink{_autodrone32_8h_a717f3163fff352053746cbea6c54fc39}{H\_PID}},           0.0f);}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00312}00312             \mbox{\hyperlink{compute__axis__commands_8c_aeadf10edda82c844091f32339605e1c3}{altitudeHoldReference}} = hEstimate;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00313}00313             \mbox{\hyperlink{compute__axis__commands_8c_a4c5161941d9a2168ef4bd69e018bfbe8}{throttleReference}}     = \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00314}00314         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00316}00316         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00320}00320     \textcolor{keywordflow}{case} \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a495e513812504424d03296e0e8e8ef55}{ALT\_HOLD\_FIXED\_AT\_ENGAGEMENT\_ALT}}:}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00321}00321         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}} == \textcolor{keyword}{true}) || \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a2a966858773d9801f7ed82c71430ffc5}{verticalVelocityHoldOnly}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00322}00322             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a23b9da3f6605abb338ef644004f650d3}{ALT\_HOLD\_AT\_REFERENCE\_ALTITUDE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00324}00324         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}] <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX2 Falling edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00325}00325             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5ae0e1424fffc0494b932a603b02d7a1f6}{ALT\_DISENGAGED\_THROTTLE\_INACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00327}00327         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a3690a0a2d199eaa84ccf706971d2de13}{AUX4}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX4 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00328}00328             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00329}00329 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00330}00330         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00331}00331 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00334}00334     \textcolor{keywordflow}{case} \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a23b9da3f6605abb338ef644004f650d3}{ALT\_HOLD\_AT\_REFERENCE\_ALTITUDE}}:}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00335}00335         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}} == \textcolor{keyword}{false}) || \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a2a966858773d9801f7ed82c71430ffc5}{verticalVelocityHoldOnly}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00336}00336             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a1bcd8736c5e7d36916e596980ca03653}{VERTICAL\_VELOCITY\_HOLD\_AT\_REFERENCE\_VELOCITY}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00338}00338         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}] <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX2 Falling edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00339}00339             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5ae0e1424fffc0494b932a603b02d7a1f6}{ALT\_DISENGAGED\_THROTTLE\_INACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00341}00341         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a3690a0a2d199eaa84ccf706971d2de13}{AUX4}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX4 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00342}00342             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00344}00344         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00347}00347 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00348}00348     \textcolor{keywordflow}{case} \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a1bcd8736c5e7d36916e596980ca03653}{VERTICAL\_VELOCITY\_HOLD\_AT\_REFERENCE\_VELOCITY}}:}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00349}00349         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a4270f800c12dfc01db1f8e9e60af4095}{vertRefCmdInDetent}} == \textcolor{keyword}{true}) \&\& !\mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a2a966858773d9801f7ed82c71430ffc5}{verticalVelocityHoldOnly}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00350}00350         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00351}00351             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a23b9da3f6605abb338ef644004f650d3}{ALT\_HOLD\_AT\_REFERENCE\_ALTITUDE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00352}00352             \mbox{\hyperlink{compute__axis__commands_8c_aeadf10edda82c844091f32339605e1c3}{altitudeHoldReference}} = hEstimate;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00353}00353         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00355}00355         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}] <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX2 Falling edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00356}00356         \{}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00357}00357             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5ae0e1424fffc0494b932a603b02d7a1f6}{ALT\_DISENGAGED\_THROTTLE\_INACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00358}00358             \mbox{\hyperlink{compute__axis__commands_8c_aeadf10edda82c844091f32339605e1c3}{altitudeHoldReference}} = hEstimate;}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00359}00359         \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00362}00362         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a3690a0a2d199eaa84ccf706971d2de13}{AUX4}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX4 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00363}00363             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00365}00365         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00366}00366 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00369}00369     \textcolor{keywordflow}{case} \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5ae0e1424fffc0494b932a603b02d7a1f6}{ALT\_DISENGAGED\_THROTTLE\_INACTIVE}}:}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00370}00370         \textcolor{keywordflow}{if} (((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] < throttleCmd + \mbox{\hyperlink{flight__command_8h_af8761c64817a68293f3ed254464d81c7}{THROTTLE\_WINDOW}}) \&\& (\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a96e6d6c3e78916bb163b52f0ea38ba68}{THROTTLE}}] > throttleCmd -\/ \mbox{\hyperlink{flight__command_8h_af8761c64817a68293f3ed254464d81c7}{THROTTLE\_WINDOW}})) ||}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00371}00371                 \mbox{\hyperlink{_autodrone32_8h_adda7ce5d0896385ad80c08bee2de8394}{eepromConfig}}.\mbox{\hyperlink{structeeprom_config__t_a2a966858773d9801f7ed82c71430ffc5}{verticalVelocityHoldOnly}})}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00372}00372             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00374}00374         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX2 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00375}00375             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a495e513812504424d03296e0e8e8ef55}{ALT\_HOLD\_FIXED\_AT\_ENGAGEMENT\_ALT}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00377}00377         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a3690a0a2d199eaa84ccf706971d2de13}{AUX4}}] > \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}) \&\& (\mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} <= \mbox{\hyperlink{_autodrone32_8h_a234028ed2ada0d36313adecfaf732ff9}{MIDCOMMAND}}))  \textcolor{comment}{// AUX4 Rising edge detection}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00378}00378             \mbox{\hyperlink{flight__command_8c_a2594cb793ee3ec9f0113f5fc28951451}{verticalModeState}} = \mbox{\hyperlink{_autodrone32_8h_a99fb83031ce9923c84392b4e92f956b5a13bf189935703fd9bb7b08f6e4f20ffd}{ALT\_DISENGAGED\_THROTTLE\_ACTIVE}};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00380}00380         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00381}00381     \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00383}00383     \mbox{\hyperlink{flight__command_8c_abd78998afecbc3d83c495e6bd317ca14}{previousAUX2State}} = \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a30059d90eb19b3af333f29f0a44f39f8}{AUX2}}];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00384}00384     \mbox{\hyperlink{flight__command_8c_a9c5d39a191446775eb305b0d519fd98d}{previousAUX4State}} = \mbox{\hyperlink{flight__command_8c_a37ab20bda603d31fc5a9ae9b386db013}{ibusChannels}}[\mbox{\hyperlink{_autodrone32_8h_a3690a0a2d199eaa84ccf706971d2de13}{AUX4}}];}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00387}00387 \}}
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00390}00390 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{flight__command_8c_source_l00393}00393 }

\end{DoxyCode}
